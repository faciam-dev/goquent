<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# orm

```go
import "github.com/faciam-dev/goquent/orm"
```

## Index

- [Constants](<#constants>)
- [func GetDriver\(name string\) \(sqldriver.Driver, bool\)](<#GetDriver>)
- [func Insert\[T any\]\(ctx context.Context, db \*DB, v T, opts ...WriteOpt\) \(sql.Result, error\)](<#Insert>)
- [func RegisterDialect\(name string, d driver.Dialect\)](<#RegisterDialect>)
- [func RegisterDriver\(name string, d sqldriver.Driver\)](<#RegisterDriver>)
- [func RegisterDriverWithDialect\(name string, d sqldriver.Driver, dialect driver.Dialect\)](<#RegisterDriverWithDialect>)
- [func ResetMetaCache\(\)](<#ResetMetaCache>)
- [func SelectAll\[T any\]\(ctx context.Context, db \*DB, q string, args ...any\) \(\[\]T, error\)](<#SelectAll>)
- [func SelectOne\[T any\]\(ctx context.Context, db \*DB, q string, args ...any\) \(T, error\)](<#SelectOne>)
- [func SelectStruct\[T any\]\(ctx context.Context, db \*DB, q string, args ...any\) \(T, error\)](<#SelectStruct>)
- [func SelectStructs\[T any\]\(ctx context.Context, db \*DB, q string, args ...any\) \(\[\]T, error\)](<#SelectStructs>)
- [func Update\[T any\]\(ctx context.Context, db \*DB, v T, opts ...WriteOpt\) \(sql.Result, error\)](<#Update>)
- [func Upsert\[T any\]\(ctx context.Context, db \*DB, v T, opts ...WriteOpt\) \(sql.Result, error\)](<#Upsert>)
- [type BoolScanPolicy](<#BoolScanPolicy>)
  - [func \(p BoolScanPolicy\) String\(\) string](<#BoolScanPolicy.String>)
- [type DB](<#DB>)
  - [func NewDB\(sqlDB \*sql.DB, dialect driver.Dialect, opts ...Option\) \*DB](<#NewDB>)
  - [func Open\(dsn string\) \(\*DB, error\)](<#Open>)
  - [func OpenWithDriver\(driverName, dsn string\) \(\*DB, error\)](<#OpenWithDriver>)
  - [func OpenWithDriverOptions\(driverName, dsn string, opts ...Option\) \(\*DB, error\)](<#OpenWithDriverOptions>)
  - [func \(db \*DB\) Begin\(\) \(Tx, error\)](<#DB.Begin>)
  - [func \(db \*DB\) BeginTx\(ctx context.Context, opts \*sql.TxOptions\) \(Tx, error\)](<#DB.BeginTx>)
  - [func \(db \*DB\) Close\(\) error](<#DB.Close>)
  - [func \(db \*DB\) Exec\(query string, args ...any\) \(sql.Result, error\)](<#DB.Exec>)
  - [func \(db \*DB\) ExecContext\(ctx context.Context, query string, args ...any\) \(sql.Result, error\)](<#DB.ExecContext>)
  - [func \(db \*DB\) Model\(v any\) \*query.Query](<#DB.Model>)
  - [func \(db \*DB\) Query\(q string, args ...any\) \(\*sql.Rows, error\)](<#DB.Query>)
  - [func \(db \*DB\) QueryContext\(ctx context.Context, q string, args ...any\) \(\*sql.Rows, error\)](<#DB.QueryContext>)
  - [func \(db \*DB\) QueryRow\(query string, args ...any\) \*sql.Row](<#DB.QueryRow>)
  - [func \(db \*DB\) QueryRowContext\(ctx context.Context, query string, args ...any\) \*sql.Row](<#DB.QueryRowContext>)
  - [func \(db \*DB\) SQLDB\(\) \*sql.DB](<#DB.SQLDB>)
  - [func \(db \*DB\) SelectMap\(ctx context.Context, q string, args ...any\) \(map\[string\]any, error\)](<#DB.SelectMap>)
  - [func \(db \*DB\) SelectMaps\(ctx context.Context, q string, args ...any\) \(\[\]map\[string\]any, error\)](<#DB.SelectMaps>)
  - [func \(db \*DB\) Table\(name string\) \*query.Query](<#DB.Table>)
  - [func \(db \*DB\) Transaction\(fn func\(tx Tx\) error\) error](<#DB.Transaction>)
  - [func \(db \*DB\) TransactionContext\(ctx context.Context, fn func\(tx Tx\) error\) error](<#DB.TransactionContext>)
- [type ErrBoolParse](<#ErrBoolParse>)
  - [func \(e ErrBoolParse\) Error\(\) string](<#ErrBoolParse.Error>)
- [type Option](<#Option>)
  - [func WithBoolScanPolicy\(p BoolScanPolicy\) Option](<#WithBoolScanPolicy>)
- [type ScanOptions](<#ScanOptions>)
- [type Tx](<#Tx>)
- [type WriteOpt](<#WriteOpt>)
  - [func Columns\(cols ...string\) WriteOpt](<#Columns>)
  - [func Omit\(cols ...string\) WriteOpt](<#Omit>)
  - [func PK\(cols ...string\) WriteOpt](<#PK>)
  - [func Returning\(cols ...string\) WriteOpt](<#Returning>)
  - [func Table\(name string\) WriteOpt](<#Table>)
  - [func WherePK\(\) WriteOpt](<#WherePK>)


## Constants

<a name="MySQL"></a>Database driver names.

```go
const (
    MySQL    = "mysql"
    Postgres = "postgres"
)
```

<a name="GetDriver"></a>
## func GetDriver

```go
func GetDriver(name string) (sqldriver.Driver, bool)
```

GetDriver retrieves a registered driver.

<a name="Insert"></a>
## func Insert

```go
func Insert[T any](ctx context.Context, db *DB, v T, opts ...WriteOpt) (sql.Result, error)
```

Insert inserts v into its table.

<a name="RegisterDialect"></a>
## func RegisterDialect

```go
func RegisterDialect(name string, d driver.Dialect)
```

RegisterDialect registers a SQL dialect for a driver name.

<a name="RegisterDriver"></a>
## func RegisterDriver

```go
func RegisterDriver(name string, d sqldriver.Driver)
```

RegisterDriver registers a database driver.

<a name="RegisterDriverWithDialect"></a>
## func RegisterDriverWithDialect

```go
func RegisterDriverWithDialect(name string, d sqldriver.Driver, dialect driver.Dialect)
```

RegisterDriverWithDialect registers a database driver along with its dialect.

<a name="ResetMetaCache"></a>
## func ResetMetaCache

```go
func ResetMetaCache()
```

ResetMetaCache clears cached reflection metadata. Intended for tests.

<a name="SelectAll"></a>
## func SelectAll

```go
func SelectAll[T any](ctx context.Context, db *DB, q string, args ...any) ([]T, error)
```

SelectAll runs the query and scans all rows into \[\]T.

<a name="SelectOne"></a>
## func SelectOne

```go
func SelectOne[T any](ctx context.Context, db *DB, q string, args ...any) (T, error)
```

SelectOne runs the query and scans the first row into T.

<a name="SelectStruct"></a>
## func SelectStruct

```go
func SelectStruct[T any](ctx context.Context, db *DB, q string, args ...any) (T, error)
```

Deprecated: Use SelectOne instead.

<a name="SelectStructs"></a>
## func SelectStructs

```go
func SelectStructs[T any](ctx context.Context, db *DB, q string, args ...any) ([]T, error)
```

Deprecated: Use SelectAll instead.

<a name="Update"></a>
## func Update

```go
func Update[T any](ctx context.Context, db *DB, v T, opts ...WriteOpt) (sql.Result, error)
```

Update updates record v.

<a name="Upsert"></a>
## func Upsert

```go
func Upsert[T any](ctx context.Context, db *DB, v T, opts ...WriteOpt) (sql.Result, error)
```

Upsert inserts or updates v using primary keys.

<a name="BoolScanPolicy"></a>
## type BoolScanPolicy



```go
type BoolScanPolicy int
```

<a name="BoolStrict"></a>

```go
const (
    BoolStrict BoolScanPolicy = iota
    BoolCompat
    BoolLenient
)
```

<a name="BoolScanPolicy.String"></a>
### func \(BoolScanPolicy\) String

```go
func (p BoolScanPolicy) String() string
```



<a name="DB"></a>
## type DB

DB provides main ORM interface.

```go
type DB struct {
    // contains filtered or unexported fields
}
```

<a name="NewDB"></a>
### func NewDB

```go
func NewDB(sqlDB *sql.DB, dialect driver.Dialect, opts ...Option) *DB
```

NewDB wraps an existing sql.DB with a dialect into DB.

<a name="Open"></a>
### func Open

```go
func Open(dsn string) (*DB, error)
```

Open opens a MySQL database with default pooling. Deprecated: use OpenWithDriver to specify a driver explicitly.

<a name="OpenWithDriver"></a>
### func OpenWithDriver

```go
func OpenWithDriver(driverName, dsn string) (*DB, error)
```

OpenWithDriver opens a database with default pooling for the given driver.

<a name="OpenWithDriverOptions"></a>
### func OpenWithDriverOptions

```go
func OpenWithDriverOptions(driverName, dsn string, opts ...Option) (*DB, error)
```

OpenWithDriverOptions opens a database with options for the given driver.

<a name="DB.Begin"></a>
### func \(\*DB\) Begin

```go
func (db *DB) Begin() (Tx, error)
```

Begin starts a transaction for manual control.

<a name="DB.BeginTx"></a>
### func \(\*DB\) BeginTx

```go
func (db *DB) BeginTx(ctx context.Context, opts *sql.TxOptions) (Tx, error)
```

BeginTx starts a transaction using ctx and returns the Tx.

<a name="DB.Close"></a>
### func \(\*DB\) Close

```go
func (db *DB) Close() error
```

Close closes underlying DB.

<a name="DB.Exec"></a>
### func \(\*DB\) Exec

```go
func (db *DB) Exec(query string, args ...any) (sql.Result, error)
```

Exec executes a raw SQL statement.

<a name="DB.ExecContext"></a>
### func \(\*DB\) ExecContext

```go
func (db *DB) ExecContext(ctx context.Context, query string, args ...any) (sql.Result, error)
```

ExecContext executes a raw SQL statement with a context.

<a name="DB.Model"></a>
### func \(\*DB\) Model

```go
func (db *DB) Model(v any) *query.Query
```

Model creates a query for the struct table.

<a name="DB.Query"></a>
### func \(\*DB\) Query

```go
func (db *DB) Query(q string, args ...any) (*sql.Rows, error)
```

Query runs a raw SQL query returning multiple rows.

<a name="DB.QueryContext"></a>
### func \(\*DB\) QueryContext

```go
func (db *DB) QueryContext(ctx context.Context, q string, args ...any) (*sql.Rows, error)
```

QueryContext runs Query with a context.

<a name="DB.QueryRow"></a>
### func \(\*DB\) QueryRow

```go
func (db *DB) QueryRow(query string, args ...any) *sql.Row
```

QueryRow executes a query that is expected to return at most one row.

<a name="DB.QueryRowContext"></a>
### func \(\*DB\) QueryRowContext

```go
func (db *DB) QueryRowContext(ctx context.Context, query string, args ...any) *sql.Row
```

QueryRowContext executes a query with context returning at most one row.

<a name="DB.SQLDB"></a>
### func \(\*DB\) SQLDB

```go
func (db *DB) SQLDB() *sql.DB
```

SQLDB returns the underlying \*sql.DB.

<a name="DB.SelectMap"></a>
### func \(\*DB\) SelectMap

```go
func (db *DB) SelectMap(ctx context.Context, q string, args ...any) (map[string]any, error)
```

Deprecated: Use SelectOne with map type instead.

<a name="DB.SelectMaps"></a>
### func \(\*DB\) SelectMaps

```go
func (db *DB) SelectMaps(ctx context.Context, q string, args ...any) ([]map[string]any, error)
```

Deprecated: Use SelectAll with map type instead.

<a name="DB.Table"></a>
### func \(\*DB\) Table

```go
func (db *DB) Table(name string) *query.Query
```

Table creates a query for table name.

<a name="DB.Transaction"></a>
### func \(\*DB\) Transaction

```go
func (db *DB) Transaction(fn func(tx Tx) error) error
```

Transaction executes fn in a transaction.

<a name="DB.TransactionContext"></a>
### func \(\*DB\) TransactionContext

```go
func (db *DB) TransactionContext(ctx context.Context, fn func(tx Tx) error) error
```

TransactionContext executes fn in a transaction using ctx.

<a name="ErrBoolParse"></a>
## type ErrBoolParse



```go
type ErrBoolParse struct {
    Column string
    Src    any
    Policy BoolScanPolicy
}
```

<a name="ErrBoolParse.Error"></a>
### func \(ErrBoolParse\) Error

```go
func (e ErrBoolParse) Error() string
```



<a name="Option"></a>
## type Option

Option configures DB at creation.

```go
type Option func(*DB)
```

<a name="WithBoolScanPolicy"></a>
### func WithBoolScanPolicy

```go
func WithBoolScanPolicy(p BoolScanPolicy) Option
```

WithBoolScanPolicy sets the bool scanning policy.

<a name="ScanOptions"></a>
## type ScanOptions



```go
type ScanOptions struct {
    BoolPolicy BoolScanPolicy
}
```

<a name="Tx"></a>
## type Tx

Tx represents a transaction\-scoped DB wrapper.

```go
type Tx struct {
    *DB
    driver.Tx
}
```

<a name="WriteOpt"></a>
## type WriteOpt

WriteOpt configures write behavior.

```go
type WriteOpt func(*writeOptions)
```

<a name="Columns"></a>
### func Columns

```go
func Columns(cols ...string) WriteOpt
```

Columns limits write to specified columns.

<a name="Omit"></a>
### func Omit

```go
func Omit(cols ...string) WriteOpt
```

Omit excludes specified columns.

<a name="PK"></a>
### func PK

```go
func PK(cols ...string) WriteOpt
```

PK specifies primary key columns for map writes.

<a name="Returning"></a>
### func Returning

```go
func Returning(cols ...string) WriteOpt
```

Returning specifies columns to return \(Postgres only\).

<a name="Table"></a>
### func Table

```go
func Table(name string) WriteOpt
```

Table sets table name \(required for map writes\).

<a name="WherePK"></a>
### func WherePK

```go
func WherePK() WriteOpt
```

WherePK uses primary key columns in WHERE clause.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
